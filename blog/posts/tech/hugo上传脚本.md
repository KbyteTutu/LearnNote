[项目路径](https://github.com/KbyteTutu/hugo_upload_script)

为了自己用着方便，花了一个钟搞了一个远程到服务器执行hugo更新的脚本。这样我本地就可以用比较熟悉的Typora写blog了，写完直接一运行脚本，完活儿~

具体直接看项目就可以了。

不过这样小的项目居然还让我踩了几个坑，记录一下算是第一个技术文档好了。

## 关于paramiko执行的小坑

这东西还挺好用的，但是确实有坑。

- 如果用exec_command来执行脚本，必须sleep一下等待完成。这个并不会阻塞，而是直接把命令怼过去。同理，invoke_shell也会因此出现还没完成命令就超前发送的情况。
    - 解决方案：要么用管道符 | 进行处理， 要么用 ; 进行命令处理（比如hugo需要切工作目录)， 要么sleep一下。
- invoke_shell 用recv会显示不全。我怀疑和上面的情况一样，因为你推送这条命令的时候终端的行缓冲器其实 没有刷新完所有内容，所以显示也不全。不过我这里只是 辅助调试一下，不是关键问题，无所谓。



## 测试上传图片

![image-20220721003143153](https://tutu.gold//posts/tech/hugo上传脚本.assets/image-20220721003143153.png)